<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap 4 -->
    <link rel="stylesheet" type="text/css" href="https://bootswatch.com/4/cerulean/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    
    <!-- DataTables -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>

    <!-- MCS Styling -->
    <link rel="stylesheet" type="text/css" href="./mcs.css">
    <title>Entfernungsmesser</title>
  </head>

  <script type="text/javascript">
    /** Diese Funktion wird ausgeführt, wenn die Seite vollständig geladen wurde **/
    $(document).ready(function() {
      /** Diese Funktion wird beim Klicken des Knopfes ausgelöst **/
      $('#adresseButton').click(function(event) {
        /** Werte aus den Eingabefeldern auslesen **/
        var longitude = $('#longitude').val();
        var latitude = $('#latitude').val();

        /** Tabelle löschen **/
        var tabelle = $('#datenTabelle').DataTable();
        tabelle.clear();
      
        /** Daten über die API laden **/
        $.getJSON('http://localhost:8000/api/entfernung?longitude='+longitude+'&latitude='+latitude, function(data) {
          $.each(data, function(index, value) {
            /** Daten zeilenweise zur Tabelle hinzufügen **/
            tabelle.row.add([value['entfernung'], value['name'], value['brand'],value['city'],value['street'],value['diesel'].toFixed(2), value['e5'].toFixed(2), value['e10'].toFixed(2)]).draw( false );
          });
        });   
      });
    }); 


  </script>
  <body>    

  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <i class="icon-logo"></i>
    <span class="navbar-text">
      Entfernungsmesser
    </span>
  </nav>

  <div class="card" style="width: 90%; margin-left: auto; margin-right: auto; margin-top: 15px;">

    <div class="input-group mb-3">
      <div class="input-group-prepend">
        <span class="input-group-text" id="basic-addon1">Longitude</span>
      </div>
      <input id="longitude" type="text" class="form-control" placeholder="Longitude">
      <div class="input-group-prepend">
        <span class="input-group-text" id="basic-addon1">Longitude</span>
      </div>
      <input id="latitude" type="text" class="form-control" placeholder="Latitude">
      <button id="adresseButton" type="button" class="btn btn-primary">Suchen</button>
    </div>

    <table id="datenTabelle" class="table table-striped table-hover">
      <thead>
        <tr>
          <th scope="col">entfernung</th>
          <th scope="col">name</th>
          <th scope="col">brand</th>
          <th scope="col">city</th>
          <th scope="col">street</th>
          <th scope="col">diesel</th>
          <th scope="col">e5</th>
          <th scope="col">e10</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>
  </body>
</html>